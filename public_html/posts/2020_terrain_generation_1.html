<html>
<head>
	<link rel="stylesheet" type="text/css" href="../style.css">
	<title>Axel Paris</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<meta http-equiv="Content-type" content="text/html; charset=utf-8"/> 
	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=AM_CHTML"></script>
</head>  
  <body>
	<br>
	<center>
		<a href="../../index.html" style="text-decoration: none;font-size:1.2em"><b>Axel Paris - PhD Student in Computer Graphics</b>
		<br>
		<hr style="width:20em;">
		</a>
		<a class="aUnderlined" href="../../index.html">Home</a> &nbsp;
		<a class="aUnderlined" href="../publications.html">Publications</a> &nbsp;
		<a class="aUnderlined" href="https://drive.google.com/file/d/1j1E-QmeV-LjHUVHJNPQibnm7WlQzME7L/view?usp=sharing">Resume</a> &nbsp;
		<a class="aUnderlined" href="mailto:axel.paris69@gmail.com">Email</a> &nbsp;
		<a class="aUnderlined" href="https://twitter.com/Axel_Paris">Twitter</a>
		<br>
	</center>
	<br>
	<div>
	<h2>Terrain Generation Techniques #1</h2>
	June 9, 2020.
	</div>
	<hr>
	Terrains are one of the most popular subject in procedural generation. You will find countless tutorials on the internet showing you how to create procedural terrains with islands, mountains and so on.
	However, these resources are sometimes inacurate, incomplete and above all, repetitive. 90% of procedural generation tutorials will show you a perlin-noise terrain with an example
	of procedural texturing based on elevation and slope. While that's a good thing for beginners that want to get started, it is also a problem for more experienced developpers looking for more advanced resources.
	<br><br>
	These serie of posts aims at showing you modern terrain generation techniques with examples, lots of images and discussion of pros and cons. By the end, you will hopefully have a better
	set of tools for your procedural terrains. Before diving in, here is a list of important statements about terrain generation:
	<ul>
	<li><b>A terrain is not a greyscale image</b>: most video games uses 2D models for terrains; often stored as a greyscale image on disk. However, terrains are not pictures and cannot be fully captured by a 2D representation.
	This is because vertical areas, which are often important in virtual worlds, are made of multiple 3D features. We will call these features <i>volumetric</i>, because they cannot be captured by a heightfield, or heightmap.
	These features include overhangs, caves, block structures but also features like big rocks found in plains, resulting from a collapsing event higher in a mountain. </li>
	<li><b>A noise-based terrain is not realistic</b>: Perlin-noise based terrains found all over the internet are not realistic. You will never, ever find a real life terrain that looks like fractal noise. However, you can find
	landforms <i>locally</i> similar to noise, and we will talk about that later.</li>
	<li><b>Terrains are made of landforms created at different scales </b>: an important aspect in terrain generation is scale. Moutain ranges are in the macro scale. They make up the coarse shape of the terrain and are
	the biggest landform. Meso-scale features include overhangs, arches, river and hills. Micro-scale is all the fine detail of the terrain that you can see in close view, in the order of centimeters. This classification, while
	very high level and not detailed, is useful when modeling terrains.</li>
	<li><b>Terrains are made of local landforms</b>: real terrains are not as self-similar as noise functions. And even if mountains ranges sometimes look the same, they are not in reality. Locality of landforms is important.</li>
	</ul>
	Along these posts, we will try to remember these rules and discuss them when implementing different techniques. So let's get started by discussing noise.
	
	<img src="../imgs/TerrainGen1.jpg">
	<center><i>This is the kind of thing you can find everywhere on the internet: left is one octave of perlin noise, 
	right is a fractal combination of the same noise. In this serie, we aim at generating better terrains than that.</i></center>
	
	<br>
	<h3> Self Similarity of noise </h3>
	Perlin noise was created by Ken Perlin in 1985, and it has been used ever since everywhere in computer graphics. Other types of noise were then created, including simplex noise, fractal noise and so on.
	While I will not discuss how they work (you can find plenty of resources about that on the internet), I will talk about some common properties of noise functions.
	<br>
	A noise or a fractal noise function is self-similar across its scale. What does it mean ? It means that no matter where you evaluate the function, it will look more or less the same. In our case, it means
	that using a fractal noise to represent the alps is not possible: you will never get the variation between plains and mountains ranges. By using a noise with a high amplitude, you will get mountains - pretty bad ones
	if you go too high. Whereas if you use a lower amplitude, you will get small hills and possibly some plain areas - but you cannot get both with a single function.
	<br><br>
	Or can you ? Well, mostly no, but you can get better results by using a function called a multifractal. The interesting property of such function is that the frequency (which determines the spacing between features)
	changes progressively with the number of octave, which leads to more interesting terrains alternating between valleys and mountains, as depicted in the following figure. However, the look
	will remain self similar across the domain - you will get the same nice pattern everywhere, making you larger terrains unrealistic and boring.
	
	<img width=70%" src="../imgs/TerrainGen2.jpg">
	<center><i>A terrain made with a Ridge multifractal noise.</i></center>
	
	<br>
	Noise functions are not all bad: they can be used to represent realistic (or at least visually convincing) landforms at a specific frequency (scale). 
	One of the principle stated at the beginning of this post was that terrains are made of landforms of different scales at different locations: for example mountain ranges and valleys (macro), rivers and drainage patterns (meso) and fine rock details (micro). 
	One good idea for efficiently representing these different scale is to use different noise functions <i>locally</i>. We have seen that noise is self-similar by construction - thus it is efficient for 
	representing one specific landform such as a single mountain range or an alternating pattern of hills and plains. Thus by combining noise primitives with different parameters, we should be able to get more realistic terrains.
	
	<br>
	<h3> Modeling with noise primitives </h3>
	The idea is not mine: some research has been made recently on this kind of constructivist model: Genevaux et al 2015. What I will explain here is just a short, maybe simpler version of what is demonstrated in the paper.
	The basic idea here is to create primitives that represents a single landform, and that have a compact support which come from a skeleton. The skeleton is used to limit the influence of the noise, and it allows us to use other primitives at different locations.
	<br>
	<br>
	An important aspect of such primitive is continuity: we have to make sure that combining primitives together will result in a smooth output without discontinuities. Let's take an example with a point skeleton. Its
	influence is 1 at the center and gradually fall off to the boundary where it eventually becomes zero. The function used to go from 1 to 0 can be anything as long as it ensures continuity. Here, we will use the following function: f(x) = (1-xÂ²)^3
	which can be translated in C++ code:
	<br><br>

	<p class="box">
	/*
	<br>\brief Compactly supported smooth interpolating function.
	<br>\param x squared distance.
	<br>\param r squared radius.
	<br>*/
	<br>float CubicFalloff(float x, float r)
	<br>{
	<br> &emsp;&emsp;return (x > r) ? 0.0f : (1.0f - x / r) * (1.0f - x / r) * (1.0f - x / r);
	<br>}
	</p>

	Now, if we combine noise with a point skeleton, we can get these kind of output.
	<br><br>
	<img width=70%" src="../imgs/TerrainGen3.jpg">
	<center><i>A fractal perlin noise combined with a point skeleton. Note the progressive fall to zero at the boundaries.</i></center>
	
	<h3> Combining different primitives </h3>
	Question is, how do we combine multiple primitives together ? This is where the constructivist aspect of the method comes into play. The short answer is that they are many way to combine primitives together: blending, replacing etc...
	For the sake of simplicity, I will show you the blending operator only. You can find the rest in the paper.
	<br><br>
	What does blending means ?
	
	<br><br>	
	<hr>
 <center>